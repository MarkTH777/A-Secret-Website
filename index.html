<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Secret Website</title>
<style>
    /* --- CSS Styles --- */
    :root {
        --bg-color: #000; /* Pure black base */
        --text-color: #fff;
        --modal-bg: rgba(255, 255, 255, 0.95); /* Slightly transparent white for letter */
        --modal-text: #333;
        --modal-video-bg: rgba(0, 0, 0, 0.8); /* Darker bg for video modal */
    }

    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        background-color: var(--bg-color);
        overflow: hidden; /* Prevent scrolling on main page */
        color: var(--text-color);
    }

    
    /* 1. Realistic Universe Background (Updated) */
    #universe-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        
        /* å¼•ç”¨æœ¬åœ°é«˜æ¸…æ˜Ÿç©ºå›¾ */
        background: url('assets/bg.jpg') no-repeat center center fixed;
        
        /* ç¡®ä¿èƒŒæ™¯è¦†ç›–å…¨å± */
        background-size: cover;
        
        /* æŠŠå›¾å±‚ç½®äºæœ€åº•å±‚ */
        z-index: -1;
        
        /* æˆ‘æŠŠä¹‹å‰çš„äº®åº¦æ»¤é•œåˆ æ‰äº†ï¼Œç°åœ¨æ˜Ÿæ˜Ÿä¼šæ›´äº®ï¼ */
        /* filter: brightness(0.8);*/
    }

    /* 2. BGM Indicator (Top-Left) */
    #bgm-indicator {
        position: fixed;
        top: 20px;
        left: 20px;
        display: flex;
        align-items: center;
        z-index: 100;
        opacity: 0.6;
        transition: opacity 0.3s;
        background: rgba(0,0,0,0.3);
        padding: 8px 12px;
        border-radius: 20px;
    }
    #bgm-indicator:hover {
        opacity: 1;
    }
    #music-icon {
        width: 24px;
        height: 24px;
        margin-right: 10px;
        /* Simple SVG Music Icon */
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'%3E%3Cpath d='M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z'/%3E%3C/svg%3E");
        background-size: contain;
        background-repeat: no-repeat;
    }
    /* Animation class added via JS when music starts */
    .rotating {
        animation: spin 3s linear infinite;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    #bgm-text {
        font-size: 14px;
        letter-spacing: 0.5px;
    }

    /* Main Container for centering content */
    .container {
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }

    /* 3. Initial Gift Box Screen */
    #initial-screen {
        text-align: center;
        transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        z-index: 10;
    }
    #gift-box-trigger {
        cursor: pointer;
        transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy effect */
    }
    #gift-box-trigger:hover {
        transform: scale(1.05);
    }
    #gift-box-img {
        /* Placeholder for realistic gift box image */
        width: 300px;
        height: auto;
        filter: drop-shadow(0 20px 30px rgba(0,0,0,0.5));
    }
    .click-hint {
        margin-top: 30px;
        font-size: 20px;
        font-weight: 300;
        opacity: 0.8;
        letter-spacing: 1px;
        animation: pulse 2s infinite ease-in-out;
    }
    @keyframes pulse {
        0%, 100% { opacity: 0.5; transform: scale(0.98); }
        50% { opacity: 1; transform: scale(1); }
    }

    /* 4. Main Content (Envelope & Video Selection) */
    #main-content {
        display: none; /* Hidden initially */
        width: 90%;
        max-width: 900px;
        justify-content: center;
        gap: 80px; /* Space between items */
        align-items: center;
        opacity: 0;
        transform: translateY(30px); /* Start slightly lower */
        transition: opacity 1s ease-out, transform 1s ease-out;
        z-index: 5;
    }
    .item-container {
        text-align: center;
        cursor: pointer;
        transition: transform 0.3s, filter 0.3s;
        flex: 1;
        max-width: 350px;
    }
    .item-container:hover {
        transform: translateY(-15px);
        filter: brightness(1.1);
    }
    .item-img {
        width: 100%;
        max-width: 300px;
        height: auto;
        display: block;
        margin: 0 auto 25px;
        /* Realistic shadow */
        filter: drop-shadow(0 15px 25px rgba(0,0,0,0.6));
    }
    .item-label {
        font-size: 22px;
        font-weight: 300;
        letter-spacing: 1px;
        text-transform: uppercase;
    }

    /* 5. Modals (Popup Windows) */
    .modal {
        display: none; /* Hidden initially */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.85); /* Dark overlay backing */
        z-index: 1000;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.4s ease;
        backdrop-filter: blur(5px); /* Blur the background universe */
    }
    .modal-content {
        position: relative;
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
        border-radius: 12px;
        box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        transform: scale(0.9);
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        /* Scrollbar styling for the modal */
        scrollbar-width: thin;
        scrollbar-color: rgba(0,0,0,0.2) transparent;
    }
    
    /* Envelope Modal Specifics */
    #envelope-modal .modal-content {
        background-color: var(--modal-bg);
        color: var(--modal-text);
        padding: 50px;
        background-image: url('assets/paper.png'); /* Subtle paper texture */
    }

    /* Video Modal Specifics */
    #video-modal .modal-content {
        background-color: transparent;
        box-shadow: none;
        max-width: 960px; /* Allow video to be larger */
    }

    /* When modal is open */
    .modal.show {
        display: flex;
        opacity: 1;
    }
    .modal.show .modal-content {
        transform: scale(1);
    }

    /* Close Button (X) */
    .close-btn {
        position: absolute;
        top: 15px;
        right: 25px;
        font-size: 36px;
        font-weight: 300;
        color: #aaa;
        cursor: pointer;
        transition: color 0.3s, transform 0.3s;
        z-index: 1001;
        line-height: 1;
    }
    .close-btn:hover {
        color: #333;
        transform: rotate(90deg);
    }
    #video-modal .close-btn {
        color: #fff; /* White close button for video modal */
        top: -40px;
        right: 0;
    }
    #video-modal .close-btn:hover {
        color: #ccc;
    }

    /* Content Styling */
    #envelope-text {
        font-size: 1.2rem;
        line-height: 1.8;
        text-align: left;
        font-family: 'Georgia', 'Times New Roman', serif; /* More classic font for letter */
    }
    #video-player {
        width: 100%;
        height: auto;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        outline: none;
    }
    
    /* Utility class */
    .hidden-completely {
        display: none !important;
    }
    
    /* Responsive adjustments for smaller screens */
    @media (max-width: 768px) {
        #main-content {
            flex-direction: column;
            gap: 40px;
        }
        #gift-box-img { width: 200px; }
        .item-img { max-width: 220px; }
        #envelope-modal .modal-content { padding: 30px 20px; }
    }

    /* --- æ–°å¢ï¼šç…§ç‰‡å’Œæ»šåŠ¨æ¡ç¾åŒ– --- */

    /* 1. ç…§ç‰‡æ ·å¼ï¼šæ‹ç«‹å¾—é£æ ¼ */
    .photo-container {
        text-align: center;
        margin: 30px 0;
    }
    .letter-photo {
        width: 80%;           /* å®½åº¦å ä¿¡çº¸çš„ 80% */
        max-width: 400px;     /* æœ€å¤§ä¸è¶…è¿‡ 400px */
        border: 10px solid #fff; /* ç™½è‰²ç›¸æ¡†è¾¹æ¡† */
        box-shadow: 0 4px 15px rgba(0,0,0,0.2); /* é˜´å½± */
        transform: rotate(-3deg); /* å¾®å¾®å‘å·¦å€¾æ–œï¼Œå¾ˆä¿çš® */
        transition: transform 0.3s;
    }
    .letter-photo:hover {
        transform: rotate(0deg) scale(1.05); /* é¼ æ ‡æ”¾ä¸Šå»ä¼šæ‘†æ­£å¹¶æ”¾å¤§ */
    }
    .photo-caption {
        margin-top: 10px;
        font-family: 'Courier New', Courier, monospace; /* æ‰‹å†™ä½“é£æ ¼ */
        color: #888;
        font-size: 14px;
    }

    /* 2. ç¾åŒ–æ»šåŠ¨æ¡ (è®©å®ƒçœ‹èµ·æ¥ç»†ç»†çš„ï¼Œä¸ä¸‘) */
    /* é’ˆå¯¹ Chrome, Safari, Edge æµè§ˆå™¨ */
    #envelope-modal .modal-content::-webkit-scrollbar {
        width: 8px;
    }
    #envelope-modal .modal-content::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.05); /* æ»šåŠ¨æ¡èƒŒæ™¯ */
        border-radius: 4px;
    }
    #envelope-modal .modal-content::-webkit-scrollbar-thumb {
        background-color: rgba(0,0,0,0.2); /* æ»šåŠ¨æ¡æ»‘å—é¢œè‰² */
        border-radius: 4px;
    }

    /* --- Cake Interaction Styles --- */
    .cake-content {
        text-align: center;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        /* è®©èƒŒæ™¯ç¨å¾®æ·±ä¸€ç‚¹ï¼Œçªå‡ºè›‹ç³• */
        background: rgba(0, 0, 0, 0.6);
        padding: 40px;
        border-radius: 20px;
        backdrop-filter: blur(5px);
    }

    /* æŒ‰é’®æŒ‰ä¸‹çš„æ•ˆæœ */
    #eat-btn:active {
        transform: scale(0.95);
    }

    /* å®šä¹‰æ¶ˆå¤±åŠ¨ç”»ï¼šå…ˆå˜å¤§(Qå¼¹)ç„¶åç¬é—´ç¼©å°æ¶ˆå¤± */
    @keyframes eatAnimation {
        0% { transform: scale(1); opacity: 1; }
        40% { transform: scale(1.2); } 
        100% { transform: scale(0); opacity: 0; }
    }

    /* JSä¼šæŠŠè¿™ä¸ªclassåŠ ç»™è›‹ç³• */
    .vanish {
        animation: eatAnimation 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    }


    /* å¼ºåˆ¶è®¾ç½®è›‹ç³•å¼¹çª—é»˜è®¤éšè— */
    #cake-modal {
        display: none; /* é»˜è®¤ä¸æ˜¾ç¤º */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.8); /* æ·±è‰²é®ç½© */
        z-index: 2000; /* ä¿è¯åœ¨æœ€ä¸Šå±‚ */
        align-items: center;
        justify-content: center;
    }

    /* åªæœ‰å½“ JS åŠ ä¸Š .show ç±»æ—¶æ‰æ˜¾ç¤º */
    #cake-modal.show {
        display: flex; /* è¿™é‡Œå¿…é¡»æ˜¯ flex æ‰èƒ½å±…ä¸­ */
    }

    /* --- éŸ³ä¹å›¾æ ‡æ—‹è½¬åŠ¨ç”» --- */
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* è¿™ä¸ªç±»ä¼šè¢« JS åŠ åˆ°å›¾æ ‡ä¸Š */
    .spin {
        animation: spin 4s linear infinite; /* 4ç§’è½¬ä¸€åœˆï¼Œæ— é™å¾ªç¯ */
    }

</style>
</head>
<body>

    <div id="universe-bg" style="background-image: url('assets/bg.jpg'); background-size: cover;"></div>

    <div id="bgm-indicator">
        <div id="music-icon"></div>
        <div id="bgm-text">Is playing: "ã€ŒHEarã€by Hiroto"</div>
    </div>

    <audio id="bgm-audio" loop preload="auto">
        <source src="assets/hear.mp3" type="audio/mpeg">
        </audio>

    <div class="container">
        <div id="initial-screen">
            <div id="gift-box-trigger">
                <img id="gift-box-img" src="assets/giftbox.png" alt="Open Me">
            </div>
            <div class="click-hint">Tap to open the gift</div>
        </div>

        <div id="main-content">
            <div class="item-container" id="envelope-trigger">
                <img class="item-img" src="assets/pngtree-a-sealed-white-envelope.png" alt="A Letter">
                <div class="item-label">Read Letter</div>
            </div>
            <div class="item-container" id="video-trigger">
                <img class="item-img" src="assets/video_icon.png" alt="Watch Video">
                <div class="item-label">Watch Video</div>
            </div>
        </div>
    </div>

    <div id="envelope-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="close-envelope-btn">&times;</span>
            <div id="envelope-text">
                <h3>Dear L,</h3>

                <p>Happy Birthday!!! I am genuinely grateful that you were born into this world. In a sea of people coming and going, I count myself so lucky that our paths crossed. You might not realize it, but you have this incredible sense of humor and a kind of "mysterious energy" on you lol.</p>

                <p>Though, you really do sleep <i>a lot</i>. I guess thatâ€™s just the universe giving you a "nerf" (debuff)â€”otherwise, youâ€™d be too powerful (is that what they call "IMBA" in Russian?).</p>
    
                <p>I sincerely hope your life is filled with happiness and that you are always surrounded by positive, loving Family and friends who truly care about you and share these beautiful years of time and youth with you.</p>

                <p>You once told me you never celebrate your birthday, and honestly, that made me feel a little sadâ€”it felt kind of lonely and such a pity. But hearing that your friends are celebrating with you this year makes me so happy.</p>
    
                <p>Anyway, I practiced a birthday song! Please don't judge my skills too hard; I picked a simple one, haha.</p>

                <p>I wish you all the best. Even though we are miles apart, you will always hold a special place in my heart.</p>

                <div class="photo-container">
                    <img src="assets/us.jpg" class="letter-photo" alt="Us">
                    <div class="photo-caption">Best Team Forever (i miss BinBong)</div>
                </div>

                <p>Since Iâ€™m so far away, I can only send you this virtual gift and cake for now. But I promise, next time we meet, I'm buying you a real slice of cake lol.</p>
    
                <p>I miss you,<br>Hiroto</p>
            </div>
        </div>
    </div>

    <div id="video-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <video id="video-player" controls>
                <source src="assets/birthdaysong.MP4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    <div id="cake-modal" class="modal-overlay">
        <div class="cake-content">
            <h2 style="color: white; margin-bottom: 20px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">A Sweet Surprise! Happy Birthday!ğŸ‚</h2>
            
            <img id="cake-img" src="assets/cake.png" alt="Cake" style="width: 200px; cursor: pointer;">
            
            <br>
            
            <button id="eat-btn" style="margin-top: 25px; padding: 12px 35px; font-size: 18px; border-radius: 25px; border: none; background: #ff6b6b; color: white; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); transition: transform 0.2s;">
                Eat Me! ğŸ´
            </button>
        </div>
    </div>

    <audio id="eat-sound" src="assets/eat.mp3"></audio>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. è·å–å…ƒç´ 
        const initialScreen = document.getElementById('initial-screen');
        const giftBoxTrigger = document.getElementById('gift-box-trigger');
        const mainContent = document.getElementById('main-content');
        
        const envelopeTrigger = document.getElementById('envelope-trigger');
        const videoTrigger = document.getElementById('video-trigger');
        
        const envelopeModal = document.getElementById('envelope-modal');
        const videoModal = document.getElementById('video-modal');
        const cakeModal = document.getElementById('cake-modal'); 
        
        const closeEnvelopeBtn = document.getElementById('close-envelope-btn'); // å¿…é¡»è¦æœ‰è¿™ä¸ªID
        const closeVideoBtn = document.querySelector('#video-modal .close-btn');
        
        const bgmAudio = document.getElementById('bgm-audio');
        const eatSound = document.getElementById('eat-sound');
        const videoPlayer = document.getElementById('video-player');
        
        const eatBtn = document.getElementById('eat-btn');
        const cakeImg = document.getElementById('cake-img');

        // åœ¨ const eatBtn ... é™„è¿‘åŠ ä¸Šè¿™è¡Œ
        const musicIcon = document.getElementById('music-icon');

        let bgmStarted = false;
        bgmAudio.volume = 0.3; // èƒŒæ™¯éŸ³ä¹éŸ³é‡

        // 2. åŠŸèƒ½å‡½æ•°
        function tryPlayBGM() {
            if (bgmAudio && bgmAudio.paused) {
                bgmAudio.play().then(() => { 
                    bgmStarted = true; 
                    // ğŸ‘‡ åŠ äº†è¿™è¡Œï¼šå¼€å§‹è½¬ï¼
                    if(musicIcon) musicIcon.classList.add('spin');
                }).catch(e => console.log("Audio waiting interaction"));
            }
        }

        function pauseBGM() { 
            if(bgmAudio) {
                bgmAudio.pause();
                // ğŸ‘‡ åŠ äº†è¿™è¡Œï¼šåœæ­¢è½¬ï¼
                if(musicIcon) musicIcon.classList.remove('spin');
            }
        }

        function openModal(modal) { modal.classList.add('show'); }
        function closeModal(modal) { modal.classList.remove('show'); }

        // 3. æ ¸å¿ƒé€»è¾‘

        // A. å¼€ç¤¼ç‰©ç›’
        giftBoxTrigger.addEventListener('click', () => {
            tryPlayBGM();
            initialScreen.style.opacity = '0';
            initialScreen.style.transform = 'translateY(-50px)';
            setTimeout(() => {
                initialScreen.classList.add('hidden-completely');
                mainContent.style.display = 'flex';
                setTimeout(() => { mainContent.style.opacity = '1'; mainContent.style.transform = 'translateY(0)'; }, 50);
            }, 800);
        });

        // B. æ‰“å¼€ä¿¡å°/è§†é¢‘
        envelopeTrigger.addEventListener('click', () => openModal(envelopeModal));
        videoTrigger.addEventListener('click', () => openModal(videoModal));

        // C. å…³é—­è§†é¢‘ (æ™®é€šå…³é—­)
        closeVideoBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeModal(videoModal);
            videoPlayer.pause();
        });


        // D. é‡ç‚¹ï¼šå…³é—­ä¿¡å° -> è§¦å‘è›‹ç³•ï¼
        closeEnvelopeBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeModal(envelopeModal); // 1. å…³ä¿¡å°
            
            // 2. ç­‰0.3ç§’å¼¹å‡ºè›‹ç³•
            setTimeout(() => {
                cakeModal.classList.add('show');
            }, 300);
        });

        // E. åƒè›‹ç³•ï¼
        eatBtn.addEventListener('click', () => {
            // 1. æ’­æ”¾éŸ³æ•ˆ
            eatSound.volume = 1.0; // éŸ³æ•ˆå¤§å£°ç‚¹
            eatSound.play().catch(e => console.log("Sound error:", e));

            // 2. æ‰§è¡Œæ¶ˆå¤±åŠ¨ç”» (è›‹ç³•å’ŒæŒ‰é’®ä¸€èµ·æ¶ˆå¤±)
            cakeImg.classList.add('vanish');
            eatBtn.classList.add('vanish');

            // 3. åŠ¨ç”»æ’­å®Œå(0.8ç§’)ï¼Œå…³é—­çª—å£å›åˆ°ä¸»é¡µ
            setTimeout(() => {
                cakeModal.classList.remove('show');
                
                // é‡ç½®ï¼Œæ–¹ä¾¿æµ‹è¯•ä¸‹ä¸€æ¬¡
                setTimeout(() => {
                    cakeImg.classList.remove('vanish');
                    eatBtn.classList.remove('vanish');
                }, 200);
            }, 800);
        });

        // F. ç‚¹å‡»å¤–éƒ¨å…³é—­é€»è¾‘
        window.addEventListener('click', (e) => {
            if (e.target === envelopeModal) {
                closeModal(envelopeModal);
                // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¿¡å°ä¹Ÿè§¦å‘è›‹ç³•
                setTimeout(() => cakeModal.classList.add('show'), 300);
            }
            if (e.target === videoModal) {
                closeModal(videoModal);
                videoPlayer.pause();
            }
            // è›‹ç³•ç•Œé¢å¼ºåˆ¶ç‚¹æŒ‰é’®ï¼Œä¸è®©ç‚¹å¤–éƒ¨å…³é—­ (é˜²æ­¢è¯¯è§¦æ²¡åƒåˆ°)
        });

        // G. è§†é¢‘äº’æ–¥é€»è¾‘
        videoPlayer.addEventListener('play', () => pauseBGM());
        videoPlayer.addEventListener('pause', () => { if (bgmStarted) tryPlayBGM(); });
        videoPlayer.addEventListener('ended', () => { if (bgmStarted) tryPlayBGM(); });


        // H. ç‚¹å‡»éŸ³ä¹å›¾æ ‡æ§åˆ¶ (æ’­æ”¾/æš‚åœ)
        if (musicIcon) {
            musicIcon.addEventListener('click', () => {
                if (bgmAudio.paused) {
                    tryPlayBGM(); // æ’­æ”¾å¹¶æ—‹è½¬
                } else {
                    pauseBGM();   // æš‚åœå¹¶åœæ­¢
                }
            });
        }

    });
</script>
</body>
</html>